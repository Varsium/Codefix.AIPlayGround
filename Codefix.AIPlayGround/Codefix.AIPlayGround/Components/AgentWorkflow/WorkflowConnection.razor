@using Codefix.AIPlayGround.Models

<svg class="workflow-connection" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 5;">
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#6c757d" />
        </marker>
    </defs>
    
    <path d="@GetConnectionPath()" 
          stroke="#6c757d" 
          stroke-width="2" 
          fill="none" 
          marker-end="url(#arrowhead)"
          class="connection-line" />
    
    <!-- Label removed temporarily to fix compilation -->
</svg>

<style>
    .connection-line {
        transition: all 0.2s ease;
        cursor: pointer;
    }

    .connection-line:hover {
        stroke: #007bff;
        stroke-width: 3;
    }

    .connection-line.selected {
        stroke: #007bff;
        stroke-width: 3;
    }
</style>

@code {
    [Parameter] public WorkflowConnection Connection { get; set; } = new();
    [Parameter] public EventCallback<WorkflowConnection> OnConnectionSelected { get; set; }
    [Parameter] public EventCallback<WorkflowConnection> OnConnectionDeleted { get; set; }

    private string GetConnectionPath()
    {
        // This would need to be calculated based on actual node positions
        // For now, return a simple path
        return "M 100 100 Q 200 50 300 100";
    }

    private double GetLabelX()
    {
        return 200; // Middle X position
    }

    private double GetLabelY()
    {
        return 40; // Above the connection
    }

    private async Task HandleConnectionClick()
    {
        await OnConnectionSelected.InvokeAsync(Connection);
    }
}
